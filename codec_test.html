<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Codec Compatibility Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .test-item {
            background: #333;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-video {
            width: 100%;
            height: 300px;
            background: #000;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .test-button {
            background: #4ecdc4;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success { background: #51cf66; color: #000; }
        .status.error { background: #ff6b6b; color: #000; }
        .status.info { background: #74c0fc; color: #000; }
        .log {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .info-box {
            background: #444;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Video Codec Compatibility Test</h1>
        
        <div class="info-box">
            <h3>üîç What We're Testing:</h3>
            <p><strong>Problem:</strong> Video plays (timestamp advances) but shows black screen on Android TV</p>
            <p><strong>Suspected Cause:</strong> Video codec incompatibility (H.265/HEVC, high resolution, or high bitrate)</p>
            <p><strong>Goal:</strong> Identify which video source works and which doesn't</p>
        </div>
        
        <div class="test-item">
            <h3>Test 1: Direct File Access (Bypasses PHP)</h3>
            <p>This tests if the issue is with PHP streaming or the video file itself</p>
            <video class="test-video" id="testVideo1" controls>
                <source src="videos/Magical Rainforest.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div>
                <button class="test-button" onclick="testVideo1()">Test Video 1</button>
                <button class="test-button" onclick="checkVideo1()">Check Status</button>
                <div id="status1" class="status info">Ready to test</div>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Test 2: Simple PHP Stream (Minimal Headers)</h3>
            <p>This tests basic PHP video streaming</p>
            <video class="test-video" id="testVideo2" controls>
                <source src="simple_video_test.php?file=Magical Rainforest.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div>
                <button class="test-button" onclick="testVideo2()">Test Video 2</button>
                <button class="test-button" onclick="checkVideo2()">Check Status</button>
                <div id="status2" class="status info">Ready to test</div>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Test 3: XAMPP Optimized Stream</h3>
            <p>This tests the current dashboard video source</p>
            <video class="test-video" id="testVideo3" controls>
                <source src="video_xampp.php?file=Magical Rainforest.mp4&dirIndex=0" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div>
                <button class="test-button" onclick="testVideo3()">Test Video 3</button>
                <button class="test-button" onclick="checkVideo3()">Check Status</button>
                <div id="status3" class="status info">Ready to test</div>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Test Results Summary</h3>
            <div id="summary" class="info-box">
                <p><strong>Expected Results:</strong></p>
                <ul>
                    <li>If ALL show black screen: Video codec incompatibility</li>
                    <li>If some work, some don't: PHP streaming issue</li>
                    <li>If ALL work: Issue is elsewhere (CSS, JavaScript, etc.)</li>
                </ul>
            </div>
        </div>
        
        <div class="test-item">
            <h3>Test Log</h3>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        const log = document.getElementById('log');
        
        function logMessage(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logEntry.style.color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            log.appendChild(logEntry);
            log.scrollTop = log.scrollHeight;
        }
        
        function testVideo1() {
            const video = document.getElementById('testVideo1');
            const status = document.getElementById('status1');
            logMessage('Testing Video 1 (direct file access)...', 'info');
            
            video.load();
            video.play().then(() => {
                logMessage('Video 1 play() succeeded!', 'success');
                status.textContent = '‚úÖ PLAY SUCCESS - Check if video is visible';
                status.className = 'status success';
            }).catch((err) => {
                logMessage(`Video 1 play() failed: ${err.name} - ${err.message}`, 'error');
                status.textContent = '‚ùå PLAY FAILED - ' + err.message;
                status.className = 'status error';
            });
        }
        
        function testVideo2() {
            const video = document.getElementById('testVideo2');
            const status = document.getElementById('status2');
            logMessage('Testing Video 2 (simple PHP stream)...', 'info');
            
            video.load();
            video.play().then(() => {
                logMessage('Video 2 play() succeeded!', 'success');
                status.textContent = '‚úÖ PLAY SUCCESS - Check if video is visible';
                status.className = 'status success';
            }).catch((err) => {
                logMessage(`Video 2 play() failed: ${err.name} - ${err.message}`, 'error');
                status.textContent = '‚ùå PLAY FAILED - ' + err.message;
                status.className = 'status error';
            });
        }
        
        function testVideo3() {
            const video = document.getElementById('testVideo3');
            const status = document.getElementById('status3');
            logMessage('Testing Video 3 (XAMPP optimized)...', 'info');
            
            video.load();
            video.play().then(() => {
                logMessage('Video 3 play() succeeded!', 'success');
                status.textContent = '‚úÖ PLAY SUCCESS - Check if video is visible';
                status.className = 'status success';
            }).catch((err) => {
                logMessage(`Video 3 play() failed: ${err.name} - ${err.message}`, 'error');
                status.textContent = '‚ùå PLAY FAILED - ' + err.message;
                status.className = 'status error';
            });
        }
        
        function checkVideo1() {
            const video = document.getElementById('testVideo1');
            logMessage(`Video 1 Status - readyState: ${video.readyState}, networkState: ${video.networkState}, src: ${video.src}`, 'info');
        }
        
        function checkVideo2() {
            const video = document.getElementById('testVideo2');
            logMessage(`Video 2 Status - readyState: ${video.readyState}, networkState: ${video.networkState}, src: ${video.src}`, 'info');
        }
        
        function checkVideo3() {
            const video = document.getElementById('testVideo3');
            logMessage(`Video 3 Status - readyState: ${video.readyState}, networkState: ${video.networkState}, src: ${video.src}`, 'info');
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            logMessage('Video codec compatibility test page loaded');
            logMessage('Testing three different video sources to isolate the issue');
            logMessage('If ALL show black screen, the issue is video codec compatibility');
            logMessage('If some work, some don\'t, the issue is PHP streaming');
        });
    </script>
</body>
</html>
